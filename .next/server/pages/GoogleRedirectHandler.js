"use strict";(()=>{var e={};e.id=67,e.ids=[67],e.modules={52:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>d});var s=a(8732),o=a(2015),n=a(2544),c=a(4822),u=a(8129),i=a(4800),l=e([u,i]);[u,i]=l.then?(await l)():l;let d=()=>{let e=(0,n.useDispatch)(),t=(0,c.useNavigate)(),[a]=(0,c.useSearchParams)();return(0,o.useEffect)(()=>{(async()=>{let r=a.get("code");if(!r){(0,u.U)("Authorization code not found"),t("/login");return}try{e((0,i.yd)({code:r})),t("/catalog")}catch(e){console.log(e),(0,u.U)(e.message),t("/login")}})()},[e,t,a]),(0,s.jsx)("div",{children:"Processing Google Authorization..."})};r()}catch(e){r(e)}})},361:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},1195:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{R:()=>n});var s=a(1428),o=e([s]);let n=(s=(o.then?(await o)():o)[0]).default.create({baseURL:"https://nodejs-hw-mongodb-auth-syz8.onrender.com",withCredentials:!0});s.default.defaults.withCredentials=!0,n.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(console.error("Unauthorized, logging out..."),localStorage.removeItem("token"),window.location.href="/"),Promise.reject(e))),s.default.create({baseURL:"https://66b1f8e71ca8ad33d4f5f63e.mockapi.io"}).interceptors.response.use(e=>e,e=>(e.response?.status===401&&(console.error("Unauthorized, logging out..."),localStorage.removeItem("token"),window.location.href="/"),Promise.reject(e))),r()}catch(e){r(e)}})},1428:e=>{e.exports=import("axios")},2015:e=>{e.exports=require("react")},2544:e=>{e.exports=require("react-redux")},3873:e=>{e.exports=require("path")},4391:e=>{e.exports=import("react-toastify")},4800:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{$4:()=>f,E8:()=>h,EV:()=>u,LE:()=>k,WT:()=>p,dt:()=>S,je:()=>g,jf:()=>y,kz:()=>l,wz:()=>d,xw:()=>m,yd:()=>R});var s=a(1195),o=a(9198),n=a(8129),c=e([s,o,n]);[s,o,n]=c.then?(await c)():c;let u=e=>{if(console.log("\uD83D\uDD0E Checking accessToken in setAuthHeader:",e),!e){console.warn("⚠️ No access token provided. Authorization header NOT set.");return}s.R.defaults.headers.common.Authorization=`Bearer ${e}`,console.log("✅ AUTH HEADER SET:",s.R.defaults.headers.common.Authorization)},i=()=>{delete s.R.defaults.headers.common.Authorization},l=(0,o.createAsyncThunk)("auth/register",async(e,t)=>{try{let t=await s.R.post("/auth/register",e,{headers:{Accept:"application/json","Content-Type":"application/json"}});return(0,n.V)("You Registers Succesfull !"),console.log("REGISTER RESPONSE:",t.data),u(t.data.data.accessToken),localStorage.setItem("token",t.data.data.accessToken),{status:t.status,data:t.data}}catch(a){let e=a.response?.data?.message||"Error register!";return t.rejectWithValue(e)}}),d=(0,o.createAsyncThunk)("user/getUser",async(e,t)=>{try{let e=await s.R.get("/users");return(0,n.V)("You get on User Succesfull"),e.data}catch(a){if(a.response?.data?.data?.message)return t.rejectWithValue(a.response.data.data.message);let e=a.response?.data?.message||"Error get All User!";return t.rejectWithValue(e)}}),h=(0,o.createAsyncThunk)("auth/login",async(e,t)=>{try{let a=await s.R.post("/auth/login",e);if(console.log("\uD83D\uDD0D API LOGIN RESPONSE:",a.data),console.log("\uD83D\uDD0D API LOGIN TOKEN:",a.data?.data?.accessToken),!a.data||!a.data.data.accessToken)return console.error("❌ API response does not contain accessToken!"),t.rejectWithValue("No accessToken in response");return u(a.data.data.accessToken),localStorage.setItem("jwt-token",a.data.data.accessToken),(0,n.V)("You Login Succesfull"),{status:a.status,data:a.data}}catch(e){return console.error("❌ LOGIN ERROR:",e.response?.data||e.message),t.rejectWithValue("Error during login!")}}),g=(0,o.createAsyncThunk)("auth/logout",async(e,t)=>{try{await s.R.post("/auth/logout"),(0,n.V)("You Logout Succesfull"),i(),localStorage.removeItem("token")}catch(e){return t.rejectWithValue("Error logOut !")}}),p=(0,o.createAsyncThunk)("auth/sendResetEmail",async(e,{rejectWithValue:t})=>{try{let t=await s.R.post("/auth/send-reset-email",{email:e});return(0,n.V)("Send Reset Email on you email Succesfull"),t.data}catch(e){return t(e.response?.data||"Error sending email")}}),m=(0,o.createAsyncThunk)("auth/resetPassword",async({newPassword:e,token:t},{rejectWithValue:a})=>{try{let a=await s.R.post("/auth/reset-pwd",{newPassword:e,token:t});return(0,n.V)("Reset on you password Succesfull"),a.data}catch(e){return a(e.response?.data||"Error resetting password")}}),f=(0,o.createAsyncThunk)("auth/refresh",async(e,{getState:t,rejectWithValue:a})=>{try{let e=t().auth.accessToken;if(console.log("\uD83D\uDD0D REFRESH TOKEN BEFORE REQUEST:",e),!e)return a("No access token found");u(e),(0,n.V)("Refresh of token Succesfull");let r=await s.R.get("/auth/refresh");return console.log("\uD83D\uDFE2 User data from refresh:",r.data),localStorage.setItem("jwt-token",r.data.accessToken||""),r.data}catch(e){if(e.response?.status===401)return console.error("❌ Unauthorized, logging out..."),a("Unauthorized");return a("Error refreshing user")}}),y=(0,o.createAsyncThunk)("user/confirm-email",async({token:e},t)=>{try{let t=await s.R.post("/auth/confirm-email",{token:e});return console.log(t),u(t.data.data.accessToken),(0,n.V)("Email confirmed"),t.data}catch(a){if(console.log(a),a.response?.data?.data?.message)return t.rejectWithValue(a.response.data.data.message);let e=a.response?.data?.message||"Email has not been confirmed";return t.rejectWithValue(e)}}),S=(0,o.createAsyncThunk)("user/get-oauth-url",async(e,t)=>{try{let{data:e}=await s.R.get("/auth/get-oauth-url");return e}catch(e){if(e.response?.data?.data?.message)return t.rejectWithValue(e.response.data.data.message);return(0,n.U)("Oauth url failed"),t.rejectWithValue(e.message)}}),k=(0,o.createAsyncThunk)("user/refresh-session",async(e,t)=>{try{let e=await s.R.post("/auth/refresh");return u(e.data.accessToken),e.data}catch(e){return t.rejectWithValue(e.message)}},{condition:(e,t)=>{let a=t.getState();return null!==a.auth.accessToken}}),R=(0,o.createAsyncThunk)("user/confirm-oauth",async(e,t)=>{try{let t=await s.R.post("/auth/confirm-oauth",{code:e});return u(t.data.accessToken),t.data}catch(a){if(a.response?.data?.data?.message)return t.rejectWithValue(a.response.data.data.message);let e=a.response?.data?.message||"Oauth confirm failed";return(0,n.U)("confirmOauth url Error failed"),t.rejectWithValue(e)}});r()}catch(e){r(e)}})},4822:e=>{e.exports=require("react-router-dom")},6435:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>y,default:()=>g,getServerSideProps:()=>f,getStaticPaths:()=>m,getStaticProps:()=>p,reportWebVitals:()=>S,routeModule:()=>P,unstable_getServerProps:()=>T,unstable_getServerSideProps:()=>w,unstable_getStaticParams:()=>E,unstable_getStaticPaths:()=>R,unstable_getStaticProps:()=>k});var s=a(7559),o=a(2499),n=a(8807),c=a(2876),u=a.n(c),i=a(4108),l=a.n(i),d=a(52),h=e([d]);d=(h.then?(await h)():h)[0];let g=(0,n.M)(d,"default"),p=(0,n.M)(d,"getStaticProps"),m=(0,n.M)(d,"getStaticPaths"),f=(0,n.M)(d,"getServerSideProps"),y=(0,n.M)(d,"config"),S=(0,n.M)(d,"reportWebVitals"),k=(0,n.M)(d,"unstable_getStaticProps"),R=(0,n.M)(d,"unstable_getStaticPaths"),E=(0,n.M)(d,"unstable_getStaticParams"),T=(0,n.M)(d,"unstable_getServerProps"),w=(0,n.M)(d,"unstable_getServerSideProps"),P=new s.PagesRouteModule({definition:{kind:o.A.PAGES,page:"/GoogleRedirectHandler",pathname:"/GoogleRedirectHandler",bundlePath:"",filename:""},components:{App:l(),Document:u()},userland:d});r()}catch(e){r(e)}})},8129:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{U:()=>c,V:()=>n});var s=a(4391),o=e([s]);s=(o.then?(await o)():o)[0];let n=e=>s.toast.success(e,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!1,progress:void 0,theme:"colored",transition:s.Zoom}),c=e=>s.toast.error(e,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!1,progress:void 0,theme:"colored",transition:s.Zoom});r()}catch(e){r(e)}})},8732:e=>{e.exports=require("react/jsx-runtime")},9198:e=>{e.exports=import("@reduxjs/toolkit")}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[725],()=>a(6435));module.exports=r})();